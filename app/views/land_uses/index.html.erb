<h1>How much of NZ is native forest?</h1>

<div id='ts-embed-1316035239791-script'><script src='http://tiles.mapbox.com/kuahyeow/api/v1/embed.js?api=mm&amp;size%5B%5D=940&amp;size%5B%5D=500&amp;center%5B%5D=172.64569091796852&amp;center%5B%5D=-41.41676308773995&amp;center%5B%5D=5&amp;layers%5B%5D=nz-regions-land-changes-2&amp;options%5B%5D=legend&amp;options%5B%5D=zoompan&amp;options%5B%5D=tooltips&amp;options%5B%5D=zoomwheel&amp;options%5B%5D=streetlevel&amp;options%5B%5D=bwdetect&amp;options%5B%5D=zoombox&amp;options%5B%5D=attribution&amp;el=ts-embed-1316035239791'></script></div>


<h3>Land use types by region and year</h3>
<p>
  This table shows the land area for each land use type in each region. It shows the changes from 1990 to 2008.
</p>

<p>
  <%= label_tag :land_type, :style => 'width: auto;' do %>
    Show only:&nbsp;
  <% end %>
  <%= select_tag :land_type, options_for_select(['All', 'Croplands', 'Forests', 'Grasslands', 'Other', 'Settlements', 'Wetlands'], :include_blank => 'All') %>
</p>

<table id="land_use" class="zebra-striped">
  <thead>
  <tr>
    <th>Region</th>
    <th class="numeric">1990 (hectares)</th>
    <th class="numeric">2008 (hectares)</th>
    <th class="numeric">Difference</th>
  </tr>
  </thead>
  <tbody>
  <% @lands.each do |previous_land, land| %>
    <tr class="<%= land_use_class(land) %>">
      <td class="">
        <div class="region_short_name" title="<%= land.region.name %>">
          <%= show_region_link land.region %> - <%= land.land_type %>
        </div>
      </td>
      <td class="numeric">
        <%= number_with_precision(previous_land.hectares, :precision => 0, :delimiter => ',') if previous_land %>
      </td>
      <td class="numeric">
        <%= number_with_precision(land.hectares, :precision => 0, :delimiter => ',') if land %>
      </td>
      <td class="numeric">
        <%= number_with_precision(land.hectares - previous_land.hectares, :precision => 0, :delimiter => ',') if previous_land %>
      </td>
    </tr>
  <% end %>
  </tbody>
</table>

<%= javascript_tag do %>
  $('#land_type').change(function(){
    if(this.value == 'All') {
      $('tr.odd').removeClass('odd');
      $('#land_use').addClass('zebra-striped');
      $('tr:hidden').show();
    } else {
      $('#land_use').removeClass('zebra-striped');
      $('tr.odd').removeClass('odd');
      var selector = 'tbody tr.' + this.value.toLowerCase();
      $('tbody tr:visible').hide()
      $(selector).show();
      $('#land_use tbody tr:visible:even').addClass('odd')
    }
  });
<% end %>
